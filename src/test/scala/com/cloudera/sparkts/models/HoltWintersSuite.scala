package com.cloudera.sparkts.models

import org.scalatest.FunSuite
import org.apache.spark.mllib.linalg._
import org.scalatest.Matchers._

class HoltWintersSuite extends FunSuite {
 
  test("InitParams Odd Period"){
    val ts = new DenseVector(Array(
        570537.0,287069.0,513627.0,475744.0,372749.0,392691.0,365820.0,371762.0,380489.0,461117.0,510448.0,379375.0,354889.0,363152.0
         ))
    val m = 7
    val model = HoltWinters.fitModel(ts, m,"BOBYQA")

    val initParams = model.initHoltWinters(ts)
    
    initParams._1 should be (414074.194 +- 1)
    initParams._2 should be (-1489.253 +- 1)
    
    val initSeasonal = initParams._3
    for(i <- 0 to initSeasonal.size-1)print(initSeasonal(i)+",")
    
    assert(1==1)
  }
  
    
  test("InitParams Even Period"){
    val ts = new DenseVector(Array(
        570537.0,287069.0,513627.0,475744.0,372749.0,392691.0,365820.0,371762.0,380489.0,461117.0,510448.0,379375.0,354889.0,363152.0,375141.0,404812.0,497512.0,534322.0,376393.0,408513.0,385068.0,418838.0,441145.0,549804.0,532282.0,471529.0,459244.0,322786.0,402969.0,436306.0,565434.0,641668.0,448542.0,343767.0,416765.0,418692.0,431592.0,535050.0,603344.0,426394.0,368503.0,422294.0,460824.0,479949.0,634493.0,636475.0,371593.0,433742.0,384255.0,421100.0,442944.0,539976.0,540323.0,423238.0,417947.0,419964.0,437294.0,431356.0,565991.0,621398.0,426804.0,435835.0,438610.0,441803.0,393815.0,526719.0,589671.0,439618.0,425283.0,419063.0,442856.0,463867.0,558982.0,594386.0,459115.0,451442.0,431100.0,433450.0,455575.0,534083.0,596930.0,450573.0,425778.0,422933.0,435630.0,453414.0,548244.0,592999.0,455681.0,434091.0,442167.0,457496.0,482491.0,615421.0,667425.0,258029.0,414119.0,386304.0,398168.0,419296.0,511460.0,566625.0,425760.0,399142.0,392683.0,442526.0,460155.0,556457.0,584601.0,431719.0,396970.0,404244.0,413685.0,433860.0,527054.0,558181.0,428760.0,402209.0,401267.0,416365.0,456927.0,575354.0,602992.0,449822.0,437631.0,422462.0,434072.0,470768.0,578826.0,649424.0,450040.0,415996.0,402262.0,413053.0,442583.0,537347.0,558733.0,436130.0,412892.0,409219.0,426359.0,454428.0,580008.0,579063.0,435304.0,421342.0,410454.0,417106.0,444069.0,543672.0,564796.0,427688.0,413919.0,411793.0,438717.0,459968.0,548613.0,558351.0,432147.0,415402.0,414904.0,430622.0,454036.0,538602.0,552761.0,420321.0,416189.0,419442.0,433052.0,456708.0,563621.0,589235.0,423206.0,411955.0,398434.0,416911.0,439773.0,526722.0,512197.0,397196.0,409632.0,418906.0,450878.0,519672.0,619046.0,406173.0,369878.0,412858.0,403153.0,409322.0,429095.0,515612.0,512178.0,393505.0,397401.0,386682.0,420435.0,449550.0,517764.0,518173.0,389217.0,399918.0,393784.0,404626.0,428903.0,517213.0,510218.0,391032.0,395692.0,390896.0,396339.0,429681.0,550309.0,547804.0,407432.0,427894.0,419548.0,426231.0,442530.0,540450.0,542487.0,414069.0,411566.0,390219.0,408871.0,430942.0,529559.0,531067.0,406961.0,410550.0,175508.0,164802.0,175185.0,214273.0,218653.0,162426.0,164472.0,164401.0,166355.0,177265.0,215162.0,221476.0,160790.0,171381.0,180150.0,176385.0,195935.0,237112.0,223748.0,166382.0,176127.0,172184.0,179160.0,190286.0,230785.0,170326.0,173002.0,174434.0,176769.0,130912.0,59317.0,63286.0,61100.0,47618.0,40739.0,39902.0,41375.0,41824.0,50434.0,47863.0,37397.0,31743.0,30636.0,34146.0,37596.0,46954.0,41886.0,33503.0,35141.0,32543.0
        ))
    val m = 10
    val model = HoltWinters.fitModel(ts, m,"BOBYQA")

    val initParams = model.initHoltWinters(ts)
    
    initParams._1 should be (406261.5500 +- 0.1)
    initParams._2 should be (879.7164 +- 0.1)
    
    val initSeasonal = initParams._3
    for(i <- 0 to initSeasonal.size-1)print(initSeasonal(i)+",")
    
    assert(1==1)
  }
}